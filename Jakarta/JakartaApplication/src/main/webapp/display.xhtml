<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Charging Dashboard CRUD</title>
    <meta charset="UTF-8" />
</h:head>

<h:body>
    <div class="card crud-demo">
        <h:form id="crudForm">
            <p:growl id="messages" showDetail="true" />

            <p:tabView>
                <!-- USERS CRUD -->
                <p:tab title="Users">
                    <p:toolbar>
                        <p:toolbarGroup>
                            <p:commandButton value="New User" icon="pi pi-plus"
                                             actionListener="#{showUsers.openNewUser}"
                                             update=":crudForm:userDialog"
                                             oncomplete="PF('userDialog').show()"
                                             styleClass="ui-button-success" />
                            <p:commandButton value="Delete Selected" icon="pi pi-trash"
                                             actionListener="#{showUsers.deleteSelectedUsers}"
                                             update=":crudForm:userTable messages"
                                             styleClass="ui-button-danger"
                                             disabled="#{empty showUsers.selectedUsers}" />
                        </p:toolbarGroup>
                    </p:toolbar>

                    <p:dataTable id="userTable" value="#{showUsers.users}" var="user"
                                 selection="#{showUsers.selectedUsers}" selectionMode="multiple"
                                 rowKey="#{user.email}" paginator="true" rows="5"
                                 editable="false" style="margin-top: 1em">

                        <p:column selectionMode="multiple" width="40" />

                        <p:column headerText="Email">
                            <h:outputText value="#{user.email}" />
                        </p:column>
                        <p:column headerText="Name">
                            <h:outputText value="#{user.name}" />
                        </p:column>
                        <p:column headerText="Balance">
                            <h:outputText value="#{user.balance}" />
                        </p:column>
                        <p:column headerText="Car Type">
                            <h:outputText value="#{user.carType}" />
                        </p:column>
                        <p:column headerText="Actions">
                            <p:commandButton icon="pi pi-pencil" update=":crudForm:userDialog"
                                             oncomplete="PF('userDialog').show()"
                                             process="@this" title="Edit">
                                <f:setPropertyActionListener value="#{user}" target="#{showUsers.selectedUser}" />
                            </p:commandButton>
                            <p:commandButton icon="pi pi-trash" title="Delete"
                                             actionListener="#{showUsers.deleteUser(user)}"
                                             update=":crudForm:userTable messages"
                                             styleClass="ui-button-warning" />
                        </p:column>
                    </p:dataTable>
                </p:tab>
            </p:tabView>

            <!-- USER DIALOG -->
            <p:dialog id="userDialog" widgetVar="userDialog" header="User Details" modal="true" closable="true"
                      responsive="true" resizable="false">
                <p:outputPanel rendered="#{not empty showUsers.selectedUser}" styleClass="ui-fluid">
                    <div class="field">
                        <p:outputLabel for="email" value="Email" />
                        <p:inputText id="email" value="#{showUsers.selectedUser.email}" required="true" />
                    </div>
                    <div class="field">
                        <p:outputLabel for="name" value="Name" />
                        <p:inputText id="name" value="#{showUsers.selectedUser.name}" />
                    </div>
                    <div class="field">
                        <p:outputLabel for="balance" value="Balance" />
                        <p:inputNumber id="balance" value="#{showUsers.selectedUser.balance}" />
                    </div>
                    <div class="field">
                        <p:outputLabel for="carType" value="Car Type" />
                        <p:inputText id="carType" value="#{showUsers.selectedUser.carType}" />
                    </div>
                </p:outputPanel>

                <f:facet name="footer">
                    <p:commandButton value="Save" icon="pi pi-check"
                                     actionListener="#{showUsers.saveUser}"
                                     update=":crudForm:userTable" oncomplete="PF('userDialog').hide()" />
                    <p:commandButton value="Cancel" icon="pi pi-times"
                                     onclick="PF('userDialog').hide()" type="button"
                                     class="ui-button-secondary" />
                </f:facet>
            </p:dialog>
        </h:form>
    </div>
</h:body>
</html>
